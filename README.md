# ChessMaster Backend

Распознавание шахматных позиций по скриншотам доски с фигурами.
**Важно:** проект предназначен для работы со скриншотами из онлайн-шахмат или интерфейсов программ, он не рассчитан на распознавание фото реальных физических досок.

Демо проекта: [https://chess.alavenir.tech/](https://chess.alavenir.tech/)

### Как это работает
Основной метод принимает изображение и координаты углов доски на этом фото (`x1, y1, x2, y2`).
1. Изображение обрезается по указанным координатам.
2. Поле делится на 64 равных квадрата.
3. Обученная нейронная сеть (TFLite) распознает фигуру в каждом квадрате отдельно.
4. На основе полученных данных генерируется FEN-код позиции и ссылка на анализ в Lichess.

### Инструкция по запуску

#### 1. Настройка базы данных
Для работы сервиса необходима база данных MySQL. Создайте файл `.env` в корне проекта на основе `.env.example` и укажите доступы.

*Примечание: Если вы хотите использовать сервис без записи данных в базу, можно модифицировать файл `app/routers.py`, удалив или закомментировав логику взаимодействия с SQLAlchemy.*

#### 2. Запуск через Docker
```bash
docker build -t chess-master .
docker run -p 8080:80 --env-file .env chess-master
```
Приложение будет доступно по адресу `http://localhost:8080`.

#### 3. Локальный запуск (Python 3.10)
```bash
pip install -r app/requirements.txt
cd app
python main.py
```

### Технологии
- FastAPI
- TensorFlow Lite (tflite-runtime)
- SQLAlchemy (MySQL)
- Pillow
- Docker

### API Документация
После запуска доступна по адресам:
- Swagger UI: `http://localhost:8080/chess_service/docs`
- ReDoc: `http://localhost:8080/chess_service/redoc`
